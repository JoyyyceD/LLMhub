# 推荐需求（V1）

## 1. 推荐目标

- 根据用户需求返回最匹配模型版本
- 输出可解释推荐结果
- 推荐数量固定目标为 Top4（允许不足 4）

## 2. 输入结构（产品层）

### 2.1 主场景模板

- 通用对话
- 代码助手
- 科学推理
- 文案创作
- 长文档 RAG
- 智能体 Agent
- 多模态
- 翻译

场景信息架构采用 `8 个一级场景 x 6 个二级任务（默认 + 5细分）`，
详见 `docs/recommendation/use-case-taxonomy.md`。

### 2.2 偏好项

- 地区可用性（例如中国大陆直连、海外可用）
- 预算偏好（省钱优先、性能均衡、质量优先）
- 速度偏好（低延迟、高吞吐、均衡）

地区偏好在 V1 的业务映射：

- `overseas`：包含全部“海外模型”集合
- `cn_mainland`：剔除全部“海外模型”集合，仅保留中国大陆可用模型
- `no_preference`：不过滤以上来源

补充规则：

- 非中国大陆厂商统一归为“海外模型”
- 未识别厂商默认归为“海外模型”

### 2.3 高级筛选（可选）

- 输入类型（PDF/文档/图片）
- 上下文长度需求
- 任务子标签（代码生成、Bug 修错等）

说明：

- 隐私合规筛选在 V1 暂不启用，不作为过滤或打分条件

### 2.4 V1 与后续扩展

- V1 采用“一级模板 + 偏好项 + 高级筛选”的输入结构
- V1 即支持“二级用途（sub_scenario）”，未传时走一级默认任务
- 设计要求：新增二级用途时仅新增配置，不改主计算链路

## 3. 输出结构（产品层）

每个推荐项至少包含：

- 模型名
- 输入/输出价格
- TTFT
- TPS
- 推荐理由
- 主要 tradeoff

结果集规则：

- 默认返回 Top4
- 满足严格规则的候选不足 4 时，返回实际数量

## 4. 推荐边界

- 推荐对象为模型版本，不区分 provider endpoint
- 用户评分与评论不参与推荐排序（V1）

## 5. 结果稳定性要求

- 同一 `snapshot` + 同一输入参数，输出排序和分数必须一致
- 当候选不足 4 时，接口返回当前可用候选，不做降级填充
